## 1. Сборка проекта (Первый вариант)

```bash
  mvn clean install
```
```bash
  mvn spring-boot:run
```

## 2. Сборка проекта

Открыть консоль в корне проекта (где находится `pom.xml`) и выполнить:

```
./mvnw clean package
```

Или, если Maven установлен глобально:

```bash
  mvn clean package
```

После этого в папке `target/` появится `.jar`-файл, например:

```
target/diploma-2-0-0.0.1-SNAPSHOT.jar
```

## 3. Запуск приложения

Чтобы запустить приложение, выполнить команду:

```bash
java -jar target/diploma-2-0-0.0.1-SNAPSHOT.jar
```

Если менялось имя JAR-файла или `artifactId`, нужно скорректировать имя файла для команды запуска.

## 4. Запуск тестов
Запускать тесты можно как обычные тесты в JUnit, например, используя IDE или команду Maven:

```bash
  mvn test
```
или 
```bash
  mvn clean test
```
- **Примечание**:
Чтобы протестировать класс ImageController, который использует сервис ImageService и работает с файлами, нужно замокать сервис и проверить каждый 
метод контроллера с использованием фреймворка тестирования Spring.
Чтобы замокать зависимости, использовать MockMvc для тестирования HTTP-запросов и аннотации из Spring, например, @MockBean.

## SQL-запросы для создания базы данных PostgreSQL

Создание базы данных и таблиц в PostgreSQL:

```
-- Создать базу данных
CREATE
DATABASE images_db;


-- Создать таблицу users
CREATE TABLE users
(
    id       SERIAL PRIMARY KEY,
    login    VARCHAR(50)  NOT NULL UNIQUE,
    password VARCHAR(100) NOT NULL    
);

-- Создать таблицу item
CREATE TABLE item
(
    id          SERIAL PRIMARY KEY,
    name        VARCHAR(100) NOT NULL,
    description TEXT,
    link        VARCHAR(200)
);

```

Добавление значений в Таблицу 'users'

```
INSERT INTO users (login, password)
VALUES ('admin', '$2a$12$LbAPCsHn8ZN5MUDqDmIX7e9n1YlDkCxEt0lW3Q2WuW0M1vteo8jvG'), -- пароль зашифрован
       ('user', '$2a$12$.dlnBAYq6sOUumn3jtG.AepxdSwGxJ8xA2iAPoCHSH61Vjl.JbIfq') -- пароль зашифрован


```

#### Страница авторизации

Это страница, на которой пользователи могут ввести свои логин и пароль для входа в систему:<br>
my-app.html

## Главная страница (index.html):

### URL: http://localhost:8084/

<br><br>



### Как использовать профиль run-all

Профиль run-all указывает Maven собирать и запускать три модуля: api-gateway, frontend-service и image-hosting.

`<id>run-all</id>` - это имя профиля в данном случае он называется run-all, и его можно использовать для активации данного профиля в командной строке.

`<modules>`- внутри профиля указаны модули, которые должны быть собраны в рамках этого профиля.

Для того чтобы запустить этот профиль и собрать все модули, нужно выполнить команду:
Эта команда активирует профиль run-all и соберет все три модуля в одном процессе.

```bash
  mvn clean install -Prun-all
```
#### Настройка для разных сред 
Можно добавить дополнительные настройки для различных окружений, например, для разработки или продакшн. 
Например, добавить настройки для конфигурации базы данных или логирования, которые могут отличаться в разных средах.

#### Использование команд для отдельных сервисов 
Если нужно собирать только один модуль, можно использовать команду без указания профиля для сборки только одного модуля.
- Эта команда соберет только модуль api-gateway:
```bash
  mvn clean install -pl api-gateway
```
- Эта команда соберет только модуль frontend-service:
```bash
  mvn clean install -pl frontend-service
```
- Эта команда соберет только модуль image-hosting:
```bash
  mvn clean install -pl image-hosting
```

Чтобы собрать все модули, указанные в профили, использовать команду:
```bash 
  mvn clean install -Prun-all
```
### Тестирование

MockMvc - используется для имитации HTTP-запросов к контроллеру и проверки его ответов. Он позволяет протестировать обработку различных запросов без реальной загрузки и отправки HTTP-запросов.
@MockBean - позволяет мокировать зависимости, такие как сервисы, чтобы изолировать контроллер и не зависеть от реальной реализации сервиса. В данном случае мы мокируем ImageService.
Mockito - используется для создания мок-объектов (например, файлов или сервисов), а также для проверки их взаимодействий с контроллером.
@RequestParam и @PathVariable - используются для передачи параметров в методы контроллера. В тестах передаются параметры как для URL, так и для формы (например, при отправке файла).
Redirect и редиректы - тестируем редиректы на страницу галереи после загрузки или удаления изображения.
Повторная проверка - мы проверяем, что правильные методы сервиса вызываются правильное количество раз (с использованием verify()).


Тесты можно запустить через команду:

```bash
  mvn test
```

#### Проверка полного стека ошибок

Чтобы понять, в чём именно проблема, использоватьь подробный вывод ошибок, добавив флаг -e или -X при запуске Maven:

- Для подробного лога:

```bash
  mvn spring-boot:run -e
```
- Для полного вывода отладки:

```bash
  mvn spring-boot:run -X
```
